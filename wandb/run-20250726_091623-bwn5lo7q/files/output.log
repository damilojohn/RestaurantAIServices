INFO:ml_pipeline.orchestrator:Instantiated Trainer...
INFO:ml_pipeline.orchestrator:Instantiated predictor.....
[2m2025-07-26 09:16:27[0m [[32m[1minfo     [0m] [1mML pipeline orchestrator instantiated....[0m
[2m2025-07-26 09:16:27[0m [[32m[1minfo     [0m] [1mInstantiating training pipeline....[0m
INFO:ml_pipeline.orchestrator:Starting training pipeline
ğŸ›’ Simulating 91 days of retail operations across 20 stores
[2m2025-07-26 09:16:28[0m [[32m[1minfo     [0m] [1mâœ… Created 36,400 sales transactions[0m
[2m2025-07-26 09:16:28[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Average daily sales per SKU: 115.1 units[0m
[2m2025-07-26 09:16:28[0m [[32m[1minfo     [0m] [1mğŸ“Š Sales volume range: 0 to 330 units/day[0m
[2m2025-07-26 09:16:28[0m [[32m[1minfo     [0m] [1mğŸ“‹ Data types: {'date': dtype('O'), 'store': dtype('int32'), 'item': dtype('int32'), 'sales': dtype('int64'), 'processing_timestamp': dtype('O')}[0m
[2m2025-07-26 09:16:28[0m [[32m[1minfo     [0m] [1mğŸ” Final DataFrame schema:     [0m
root
 |-- date: date (nullable = true)
 |-- store: integer (nullable = true)
 |-- item: integer (nullable = true)
 |-- sales: long (nullable = true)
 |-- processing_timestamp: timestamp (nullable = false)

[2m2025-07-26 09:16:28[0m [[32m[1minfo     [0m] [1mğŸ’¾ Writing to: forecasting.raw_sales_data[0m
[2m2025-07-26 09:16:35[0m [[32m[1minfo     [0m] [1mâœ… Sales history loaded successfully![0m
[2m2025-07-26 09:16:36[0m [[32m[1minfo     [0m] [1mğŸ“Š Rows written: 36,400        [0m
[2m2025-07-26 09:16:36[0m [[32m[1minfo     [0m] [1mğŸ” Data Quality Report:        [0m
[2m2025-07-26 09:16:36[0m [[32m[1minfo     [0m] [1m==================================================[0m
[2m2025-07-26 09:16:38[0m [[32m[1minfo     [0m] [1mğŸ“Š Total records: 36,400       [0m
[2m2025-07-26 09:16:38[0m [[32m[1minfo     [0m] [1mğŸ“… Date range: 2025-04-27 to 2025-07-26[0m
[2m2025-07-26 09:16:38[0m [[32m[1minfo     [0m] [1mğŸª Unique stores: 20           [0m
[2m2025-07-26 09:16:38[0m [[32m[1minfo     [0m] [1mğŸ“¦ Unique items: 20            [0m
/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/jupyter_client/connect.py:22: DeprecationWarning: Jupyter is migrating its paths to use standard platformdirs
given by the platformdirs library.  To remove this warning and
see the appropriate new directories, set the environment variable
`JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
The use of platformdirs will be the default in `jupyter_core` v6
  from jupyter_core.paths import jupyter_data_dir, jupyter_runtime_dir, secure_write
[2m2025-07-26 09:16:38[0m [[32m[1minfo     [0m] [1mâœ… Completeness: 36,400 sales records (100% complete)[0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Sales count: 36400.00       [0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Sales mean: 115.07          [0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Sales stddev: 40.73         [0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Sales min: 0.00             [0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Sales max: 330.00           [0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1m
ğŸ¯ Retail sales data validated and ready for demand forecasting![0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“¥ Loading retail sales history for AI analysis...[0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mâœ… Sales data ready for analysis[0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ›’ Total sales transactions: 36,400[0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸ“… Date range: 2025-04-27 to 2025-07-26[0m
[2m2025-07-26 09:16:39[0m [[32m[1minfo     [0m] [1mğŸª Stores: 20                  [0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1mğŸ“¦ Items: 20                   [0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1mğŸ” Analyzing sales patterns for AI model training...[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1mğŸ“ˆ Analyzing 75 store-item combinations:[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 15: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 10: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 13: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 7: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 7: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 6: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 11: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 9: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 10: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 4: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 12: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 13: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 13: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 15: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 3: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 11: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 6: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 14: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 6: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 10: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 9: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 8: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 15: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 14: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 2: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 1: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 3: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 12: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 8: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 2: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 4: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 1: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 7: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 9: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 11: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 14: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 8: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 5: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 5, Item 5: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 4, Item 12: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 1: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 2: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 7: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 3: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 2: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 9: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 1: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 3: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 14: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 5: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 11: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 5: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 4: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 9: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 15: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 3: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 8: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 1: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 4: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 14: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 11: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 12: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 10: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 12: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 2: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 5: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 15: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 13: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 3, Item 4: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 8: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 6: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 1, Item 10: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 7: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 13: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m   âœ… Store 2, Item 6: 91 records, 91 days[0m
[2m2025-07-26 09:16:40[0m [[32m[1minfo     [0m] [1m
ğŸ¯ 75/75 product-store combinations ready for AI forecasting[0m
[2m2025-07-26 09:16:41[0m [[32m[1minfo     [0m] [1mğŸ¯ Discovered 400 store-item combinations in data[0m
INFO:ml_pipeline.trainer:Starting model training
DEBUG:cmdstanpy:input tempfile: /var/folders/t1/4k5475yj5b13x6zbbfjr5kj80000gn/T/tmpyvg0gcs9/hb3gmx22.json
DEBUG:cmdstanpy:input tempfile: /var/folders/t1/4k5475yj5b13x6zbbfjr5kj80000gn/T/tmpyvg0gcs9/wukzet9j.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: ['/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/prophet/stan_model/prophet_model.bin', 'random', 'seed=18068', 'data', 'file=/var/folders/t1/4k5475yj5b13x6zbbfjr5kj80000gn/T/tmpyvg0gcs9/hb3gmx22.json', 'init=/var/folders/t1/4k5475yj5b13x6zbbfjr5kj80000gn/T/tmpyvg0gcs9/wukzet9j.json', 'output', 'file=/var/folders/t1/4k5475yj5b13x6zbbfjr5kj80000gn/T/tmpyvg0gcs9/prophet_model0zoo729f/prophet_model-20250726091642.csv', 'method=optimize', 'algorithm=newton', 'iter=10000']
09:16:42 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
09:16:42 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/mlflow/models/model.py:421: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.utc_time_created = str(utc_time_created or datetime.utcnow())
2025/07/26 09:16:44 WARNING mlflow.utils.environment: Failed to resolve installed pip version. ``pip`` will be added to conda.yaml environment spec without a version specifier.
2025/07/26 09:16:44 INFO mlflow.models.model: Found the following environment variables used during model inference: [WANDB_API_KEY]. Please check if you need to set them when deploying the model. To disable this message, set environment variable `MLFLOW_RECORD_ENV_VARS_IN_MODEL_LOGGING` to `false`.
[2m2025-07-26 09:16:45[0m [[32m[1minfo     [0m] [1mModel Trained successfully....[0m
ğŸƒ View run adorable-conch-426 at: http://127.0.0.1:8000/#/experiments/292785914983623969/runs/46354a66d9824130839fbafc6b8022e4
ğŸ§ª View experiment at: http://127.0.0.1:8000/#/experiments/292785914983623969
[2m2025-07-26 09:16:45[0m [[32m[1minfo     [0m] [1mAPI Started.....              [0m
INFO:ml_pipeline.orchestrator:Starting prediction pipeline
<mlflow.models.model.ModelInfo object at 0x1662aaa50>
Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:00<00:00, 37.89it/s]
INFO:ml_pipeline.predictor:Model loaded successfully from MLflow
INFO:ml_pipeline.orchestrator:model loaded <prophet.forecaster.Prophet object at 0x1652bfed0> say empty  model is here
ğŸ¯ Discovered 400 store-item combinations in data
ğŸ“ˆ Processed 25/400 combinations...
ğŸ“ˆ Processed 50/400 combinations...
ğŸ“ˆ Processed 75/400 combinations...
ğŸ“ˆ Processed 100/400 combinations...
ğŸ“ˆ Processed 125/400 combinations...
ğŸ“ˆ Processed 150/400 combinations...
ğŸ“ˆ Processed 175/400 combinations...
ğŸ“ˆ Processed 200/400 combinations...
ğŸ“ˆ Processed 225/400 combinations...
ğŸ“ˆ Processed 250/400 combinations...
ğŸ“ˆ Processed 275/400 combinations...
ğŸ“ˆ Processed 300/400 combinations...
ğŸ“ˆ Processed 325/400 combinations...
ğŸ“ˆ Processed 350/400 combinations...
ğŸ“ˆ Processed 375/400 combinations...
ğŸ“ˆ Processed 400/400 combinations...
âœ… Forecasting complete! Generated predictions for 400 combinations
ğŸ”® Generated 6,000 individual demand predictions
      store  item  ...  yhat_upper                        model_version
0        10     2  ...  151.309045  prophet_v1.1.5_serverless_optimized
1        10     2  ...  131.571266  prophet_v1.1.5_serverless_optimized
2        10     2  ...  121.900973  prophet_v1.1.5_serverless_optimized
3        10     2  ...  111.111294  prophet_v1.1.5_serverless_optimized
4        10     2  ...  111.273804  prophet_v1.1.5_serverless_optimized
...     ...   ...  ...         ...                                  ...
5995      6     4  ...   68.188544  prophet_v1.1.5_serverless_optimized
5996      6     4  ...   69.560695  prophet_v1.1.5_serverless_optimized
5997      6     4  ...   72.637786  prophet_v1.1.5_serverless_optimized
5998      6     4  ...   75.268359  prophet_v1.1.5_serverless_optimized
5999      6     4  ...   81.215077  prophet_v1.1.5_serverless_optimized

[6000 rows x 7 columns]
INFO:ml_pipeline.predictor:prediction storing failed.... with error tuple indices must be integers or slices, not str
ERROR:ml_pipeline.orchestrator:Prediction pipeline failed: tuple indices must be integers or slices, not str
[32mINFO[0m:     Application startup complete.
[32mINFO[0m:     Uvicorn running on [1mhttp://127.0.0.1:54300[0m (Press CTRL+C to quit)
[2m2025-07-26 09:21:37[0m [[32m[1minfo     [0m] [1mAPI Shutting down .....       [0m
[31mERROR[0m:    Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "uvloop/loop.pyx", line 1512, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1505, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1379, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 557, in uvloop.loop.Loop._run
  File "uvloop/handles/poll.pyx", line 216, in uvloop.loop.__on_uvpoll_event
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 66, in uvloop.loop.Handle._run
  File "uvloop/loop.pyx", line 399, in uvloop.loop.Loop._read_from_self
  File "uvloop/loop.pyx", line 404, in uvloop.loop.Loop._invoke_signals
  File "uvloop/loop.pyx", line 379, in uvloop.loop.Loop._ceval_process_signals
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pyspark/core/context.py", line 390, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/starlette/routing.py", line 701, in lifespan
    await receive()
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/queues.py", line 186, in get
    await getter
asyncio.exceptions.CancelledError

INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
INFO:py4j.clientserver:Closing down clientserver connection
