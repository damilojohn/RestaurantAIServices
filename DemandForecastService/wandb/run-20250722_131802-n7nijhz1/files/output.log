INFO:ml_pipeline.orchestrator:Starting training pipeline
INFO:ml_pipeline.extractor:Loading Orders and OrderDetails as DataFrames...
INFO:ml_pipeline.extractor:Extracted data successfully
INFO:ml_pipeline.extractor:Index(['order_date', 'restaurant_id', 'item_id', 'quantity', 'unit_price',
       'day_of_week', 'is_weekend'],
      dtype='object')
INFO:ml_pipeline.preprocessor:Starting feature engineering
INFO:ml_pipeline.preprocessor:Index(['order_date', 'restaurant_id', 'item_id', 'quantity', 'unit_price',
       'day_of_week', 'is_weekend'],
      dtype='object')
ERROR:ml_pipeline.orchestrator:Training pipeline failed: Length mismatch: Expected axis has 5 elements, new values have 6 elements
[31mERROR[0m:    Traceback (most recent call last):
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/starlette/routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               ~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 134, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               ~~~~~~~~~~~~~~~~^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/main.py", line 29, in lifespan
    orchestrator.run_training_pipeline()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/ml_pipeline/orchestrator.py", line 41, in run_training_pipeline
    features = self.feature_engineer.create_features(df)
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/ml_pipeline/preprocessor.py", line 47, in create_features
    daily_demand.columns = ['restaurant_id', 'item_id', 'date', 'daily_demand', 'daily_revenue', 'daily_orders']
    ^^^^^^^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/generic.py", line 6332, in __setattr__
    return object.__setattr__(self, name, value)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/generic.py", line 814, in _set_axis
    self._mgr.set_axis(axis, labels)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/internals/managers.py", line 238, in set_axis
    self._validate_set_axis(axis, new_labels)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/internals/base.py", line 98, in _validate_set_axis
    raise ValueError(
    ...<2 lines>...
    )
ValueError: Length mismatch: Expected axis has 5 elements, new values have 6 elements

[31mERROR[0m:    Application startup failed. Exiting.
