ERROR:ml_pipeline.predictor:Failed to load model: RESOURCE_DOES_NOT_EXIST: Registered Model with name=demand_forecasting_xgb not found
INFO:ml_pipeline.orchestrator:Starting training pipeline
INFO:ml_pipeline.extractor:Loading Orders and OrderDetails as DataFrames...
INFO:ml_pipeline.extractor:Extracted data successfully
INFO:ml_pipeline.extractor:                                     Id  ...  order_date
0  0086f603-c118-4ff4-bcca-6e1480413363  ...  2025-07-01
1  1517200a-e53b-470d-a7c4-a34830ccc9e0  ...  2025-07-15
2  17c56774-0086-466f-ab9f-e0a07afc3960  ...  2025-06-29
3  25b2effb-b716-4e9c-b60a-b85c480bb1f3  ...  2025-07-12
4  25dceac3-7639-49c5-b65f-7b25d7469d5e  ...  2025-06-29

[5 rows x 22 columns]
ERROR:ml_pipeline.orchestrator:Training pipeline failed: 'item_id'
[31mERROR[0m:    Traceback (most recent call last):
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'item_id'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/starlette/routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               ~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/fastapi/routing.py", line 134, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               ~~~~~~~~~~~~~~~~^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/main.py", line 29, in lifespan
    orchestrator.run_training_pipeline()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/ml_pipeline/orchestrator.py", line 38, in run_training_pipeline
    df = self.extractor.extract_orders(start_date, end_date)
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/ml_pipeline/extractor.py", line 50, in extract_orders
    'item_id': row['item_id'],
               ~~~^^^^^^^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/series.py", line 1130, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/series.py", line 1246, in _get_value
    loc = self.index.get_loc(label)
  File "/Users/onyekachiobute/Documents/RestaurantAIServices/DemandForecastService/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'item_id'

[31mERROR[0m:    Application startup failed. Exiting.
